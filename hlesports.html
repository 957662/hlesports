<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>华立E-sports项目数据监控看板</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .title h1 {
            font-size: 28px;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 5px;
        }
        
        .title p {
            color: #a0a0c0;
            font-size: 16px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #ff7e5f, #feb47b);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .panel {
            background: rgba(30, 30, 50, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .panel-title {
            font-size: 20px;
            font-weight: 600;
            color: #feb47b;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: rgba(20, 20, 40, 0.8);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            background: rgba(30, 30, 60, 0.9);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin: 10px 0;
            background: linear-gradient(to right, #ff7e5f, #feb47b);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .stat-label {
            color: #a0a0c0;
            font-size: 14px;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 10px;
            overflow: hidden;
        }
        
        th {
            background: rgba(255, 126, 95, 0.2);
            color: #ff7e5f;
            text-align: left;
            padding: 15px;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.03);
        }
        
        tr:hover {
            background: rgba(255, 126, 95, 0.1);
        }
        
        .status-cell {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
        }
        
        .status-good {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .status-warning {
            background: rgba(241, 196, 15, 0.2);
            color: #f1c40f;
        }
        
        .status-bad {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 25px;
        }
        
        .chart-panel {
            background: rgba(30, 30, 50, 0.7);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chart-container {
            height: 300px;
            position: relative;
        }
        
        footer {
            text-align: center;
            padding: 30px 0;
            color: #a0a0c0;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 992px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .stats-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 576px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .panel {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-section">
                <div class="logo">HE</div>
                <div class="title">
                    <h1>华立E-sports项目数据监控看板</h1>
                    <p>实时追踪关键指标，优化项目执行效果</p>
                </div>
            </div>
            <div class="controls">
                <button class="btn btn-secondary" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i> 刷新数据
                </button>
                <button class="btn btn-primary" id="exportBtn">
                    <i class="fas fa-file-excel"></i> 导出Excel
                </button>
            </div>
        </header>
        
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-label">社群活跃用户</div>
                <div class="stat-value">1,320</div>
                <div class="stat-diff status-good">+12.5%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">作品播放量</div>
                <div class="stat-value">8.2M</div>
                <div class="stat-diff status-good">+23.8%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">产品销售总额</div>
                <div class="stat-value">¥186,500</div>
                <div class="stat-diff status-warning">+8.2%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">项目完成度</div>
                <div class="stat-value">68%</div>
                <div class="stat-diff status-bad">-4.5%</div>
            </div>
        </div>
        
        <div class="dashboard">
            <div class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">关键指标监控表</h2>
                    <div class="panel-actions">
                        <select id="periodSelect">
                            <option>最近7天</option>
                            <option selected>最近30天</option>
                            <option>项目一期</option>
                        </select>
                    </div>
                </div>
                <div class="table-container">
                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th>关键指标</th>
                                <th>目标值</th>
                                <th>实际值</th>
                                <th>完成率</th>
                                <th>偏差分析</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>社群活跃用户数</td>
                                <td>1,500</td>
                                <td>1,320</td>
                                <td>88%</td>
                                <td>江门校区招募进度滞后</td>
                                <td><span class="status-cell status-warning">需关注</span></td>
                            </tr>
                            <tr>
                                <td>作品总播放量</td>
                                <td>10,000,000</td>
                                <td>8,200,000</td>
                                <td>82%</td>
                                <td>内容产出频率不足</td>
                                <td><span class="status-cell status-warning">需关注</span></td>
                            </tr>
                            <tr>
                                <td>粉丝增长数</td>
                                <td>100,000</td>
                                <td>86,500</td>
                                <td>86.5%</td>
                                <td>新粉丝获取成本较高</td>
                                <td><span class="status-cell status-warning">需关注</span></td>
                            </tr>
                            <tr>
                                <td>学生IP孵化数量</td>
                                <td>3</td>
                                <td>2</td>
                                <td>66.7%</td>
                                <td>潜力学生挖掘不足</td>
                                <td><span class="status-cell status-bad">落后</span></td>
                            </tr>
                            <tr>
                                <td>赛事承办场次</td>
                                <td>2-3</td>
                                <td>3</td>
                                <td>100%</td>
                                <td>超额完成目标</td>
                                <td><span class="status-cell status-good">优秀</span></td>
                            </tr>
                            <tr>
                                <td>产品销售额</td>
                                <td>¥350,000</td>
                                <td>¥186,500</td>
                                <td>53.3%</td>
                                <td>驾校产品转化率低</td>
                                <td><span class="status-cell status-bad">落后</span></td>
                            </tr>
                            <tr>
                                <td>ATC联名T恤销量</td>
                                <td>200</td>
                                <td>158</td>
                                <td>79%</td>
                                <td>设计款式接受度一般</td>
                                <td><span class="status-cell status-good">良好</span></td>
                            </tr>
                            <tr>
                                <td>培训参与人数</td>
                                <td>60</td>
                                <td>72</td>
                                <td>120%</td>
                                <td>免费体验活动效果显著</td>
                                <td><span class="status-cell status-good">优秀</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">项目健康度分析</h2>
                    <div class="panel-actions">
                        <select id="analysisSelect">
                            <option>整体项目</option>
                            <option selected>IP账号</option>
                            <option>电竞赛事</option>
                            <option>社群搭建</option>
                            <option>教育培训</option>
                            <option>产品销售</option>
                        </select>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="healthChart"></canvas>
                </div>
            </div>
        </div>
        
        <div class="charts-container">
            <div class="chart-panel">
                <div class="panel-header">
                    <h2 class="panel-title">收入结构分析</h2>
                </div>
                <div class="chart-container">
                    <canvas id="revenueChart"></canvas>
                </div>
            </div>
            
            <div class="chart-panel">
                <div class="panel-header">
                    <h2 class="panel-title">月度指标趋势</h2>
                </div>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>
        </div>
        
        <footer>
            <p>华立E-sports项目组 © 2025 | 数据更新时间: 2025-08-12 16:45</p>
            <p>本看板数据每30分钟自动更新一次 | 技术支持: 华立数字创新中心</p>
        </footer>
    </div>

    <script>
        // 表格导出功能
        document.getElementById('exportBtn').addEventListener('click', function() {
            // 获取表格元素
            const table = document.getElementById('dataTable');
            
            // 创建工作簿
            const wb = XLSX.utils.book_new();
            
            // 从表格创建工作表
            const ws = XLSX.utils.table_to_sheet(table);
            
            // 将工作表添加到工作簿
            XLSX.utils.book_append_sheet(wb, ws, "关键指标监控");
            
            // 导出Excel文件
            XLSX.writeFile(wb, "华立E-sports项目关键指标监控.xlsx");
            
            // 显示导出成功提示
            alert('Excel文件导出成功！');
        });
        
        // 刷新按钮功能
        document.getElementById('refreshBtn').addEventListener('click', function() {
            const btn = this;
            const icon = btn.querySelector('i');
            
            // 添加旋转动画
            icon.style.transition = 'transform 0.5s ease';
            icon.style.transform = 'rotate(360deg)';
            
            // 模拟数据刷新
            setTimeout(() => {
                icon.style.transform = 'rotate(0deg)';
                alert('数据已刷新！');
            }, 800);
        });
        
        // 图表初始化
        window.onload = function() {
            // 项目健康度雷达图
            const healthCtx = document.getElementById('healthChart').getContext('2d');
            const healthChart = new Chart(healthCtx, {
                type: 'radar',
                data: {
                    labels: ['粉丝增长', '内容产出', '社群活跃', '赛事组织', '产品销售', '培训效果'],
                    datasets: [{
                        label: '当前状态',
                        data: [86, 82, 88, 100, 53, 120],
                        fill: true,
                        backgroundColor: 'rgba(254, 180, 123, 0.2)',
                        borderColor: 'rgb(254, 180, 123)',
                        pointBackgroundColor: 'rgb(254, 180, 123)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(254, 180, 123)'
                    }, {
                        label: '目标值',
                        data: [100, 100, 100, 100, 100, 100],
                        fill: true,
                        backgroundColor: 'rgba(255, 126, 95, 0.2)',
                        borderColor: 'rgb(255, 126, 95)',
                        pointBackgroundColor: 'rgb(255, 126, 95)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgb(255, 126, 95)'
                    }]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            pointLabels: {
                                color: '#a0a0c0',
                                font: {
                                    size: 12
                                }
                            },
                            ticks: {
                                display: false,
                                stepSize: 20
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#a0a0c0'
                            }
                        }
                    }
                }
            });
            
            // 收入结构饼图
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            const revenueChart = new Chart(revenueCtx, {
                type: 'doughnut',
                data: {
                    labels: ['1+1体验营', '7天KLG体验营', 'ATC潮服销售', '驾校报名', '专升本报名', '其他产品'],
                    datasets: [{
                        label: '收入占比',
                        data: [89, 3, 2, 4, 1, 1],
                        backgroundColor: [
                            'rgba(255, 126, 95, 0.8)',
                            'rgba(254, 180, 123, 0.8)',
                            'rgba(46, 204, 113, 0.8)',
                            'rgba(52, 152, 219, 0.8)',
                            'rgba(155, 89, 182, 0.8)',
                            'rgba(149, 165, 166, 0.8)'
                        ],
                        borderColor: [
                            'rgba(255, 126, 95, 1)',
                            'rgba(254, 180, 123, 1)',
                            'rgba(46, 204, 113, 1)',
                            'rgba(52, 152, 219, 1)',
                            'rgba(155, 89, 182, 1)',
                            'rgba(149, 165, 166, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#a0a0c0',
                                padding: 20,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.parsed}%`;
                                }
                            }
                        }
                    }
                }
            });
            
            // 月度指标趋势图
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            const trendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['5月', '6月', '7月', '8月', '9月', '10月(预测)'],
                    datasets: [{
                        label: '社群活跃用户(千)',
                        data: [0.8, 1.1, 0.9, 1.3, 1.5, 1.8],
                        borderColor: 'rgb(255, 126, 95)',
                        backgroundColor: 'rgba(255, 126, 95, 0.1)',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: '作品播放量(百万)',
                        data: [3.2, 4.5, 5.1, 6.8, 8.2, 10.5],
                        borderColor: 'rgb(254, 180, 123)',
                        backgroundColor: 'rgba(254, 180, 123, 0.1)',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: '销售额(万元)',
                        data: [45, 68, 72, 105, 186, 240],
                        borderColor: 'rgb(46, 204, 113)',
                        backgroundColor: 'rgba(46, 204, 113, 0.1)',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#a0a0c0'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: '#a0a0c0'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#a0a0c0'
                            }
                        }
                    }
                }
            });
        };
    </script>
</body>
</html>